\documentclass[11pt]{article}
\usepackage[letterpaper, margin=2cm]{geometry}
\usepackage{titlesec}
\usepackage{mdframed}
\usepackage[dvipsnames]{xcolor} % for color names, must be loaded before tikz
\usepackage{ifthen}
\usepackage{comment}
\usepackage{fancyhdr}
\usepackage{fancyvrb}
\usepackage{titling}
\usepackage{hyperref}
\usepackage{enumitem}
\usepackage{tikz}
\usepackage{amsmath, amssymb, amsthm}

\providecommand{\due}{}
\lhead{Virtualization} \rhead{The University of Texas}
\lfoot{\due} \cfoot{} \rfoot{Page \thepage}
\renewcommand{\footrulewidth}{0.4pt}
\pagestyle{fancy}

% Eliminates the spacing in the title that remains from the empty author section.
\preauthor{}
\postauthor{}

\titleformat{\section}[runin]{\large\bfseries}{\thesection .}{3pt}{}
\titleformat{\subsection}[runin]{\bfseries}{\thesubsection)}{3pt}{}
\renewcommand\thesubsection{\alph{subsection}}

% Defines the solution environment. Toggle solutions between true and false to either show or hide solutions. Also, the solution environment takes an optional argument of arbitrary text to be inserted in the solution header.
\newboolean{solutions}
\setboolean{solutions}{true}
\ifthenelse{\boolean{solutions}}
{\newenvironment{solution}{\begin{mdframed}[skipbelow=0pt, linecolor=White, backgroundcolor=Green!10]\textbf{Solution:}}{\end{mdframed}}}
{\excludecomment{solution}}

\allowdisplaybreaks

\begin{document}

\title{Virtualization\\Pre-lab Questions --- \#1}
\date{\due}

\maketitle

\noindent \textbf{Point total:} 7
\\ All homework assignments are weighted equally in the final grade. Point values are unique to each lab assignment.

\textbf{Note:} For all problems which ask you to explain your reasoning or show your work, you do not need to show every step of each calculation, but the answer should include an explanation \emph{written with words} of what you did.  Even when work is not required to be shown, itâ€™s a good idea to include anyways so that you can earn partial credit.

\section{Question [1 point]}

What does the \texttt{cpuid} assembly instruction do in this function?

\begin{solution}
It takes an input/flag as info and it copies the values in the registers eax, ebx, ecx, edx to the 32bit variables eax, ebx, ecx, edx.
\end{solution}


\section{Question [1 point]}

How is the function providing values back to you to use?

\begin{solution}
The function sets the values of variables eax, ebx, ecx, edx to the values in registers eax, ebx, ecx, edx. It passes the variables by reference which now sets the variable values to the values in the registers.  We can now use the variables eax, ebx, ecx, edx with their updated values.
\end{solution}


\section{Question [1 point]}

What are the results of \texttt{eax}, \texttt{ecx}, and \texttt{ebx} values in hexadecimal?

\begin{solution}
(gdb) p/x eax
$51 = 0x4
(gdb) p/x ebx
$52 = 0x756e6547
(gdb) p/x ecx
$53 = 0x6c65746e
\end{solution}


\section{Question [1 point]}

Now examine the values of these variables as strings. Hint: look at the values in hexadecimal and translate them to strings, in the order \texttt{ebx}, \texttt{edx}, \texttt{ecx}. What do you observe? The \href{https://en.wikipedia.org/wiki/CPUID}{Wikipedia page} for the cpuid instruction may help you interpret this output.

\begin{solution}
(gdb) p/s ebx
$62 = 1970169159
0x756e6547
0x47 = G
0x65 = e
0x6e = n
0x75 = u
Genu
(gdb) p/s edx
$63 = 1231384169
0x49656e69
0x69 = i
0x6e = n
0x65 = e
0x49 = I
ineI
(gdb) p/s ecx
$64 = 1818588270
0x49656e69
0x69 = n
0x6e = t
0x65 = e
0x49 = l
ntel

Final = GenuineIntel
\end{solution}


\section{Question [1 point]}

There is a reference in each \texttt{Env} struct for another struct called \texttt{VmxGuestInfo}. What kind of information does this struct hold?

\begin{solution}
The vmcs is a data structure in memory that exists once per VM while the VMM manages it. Whenever there is a context switch, the VMCS is restored for the current VM, defining the state of the VM virtual processor.
\end{solution}


\section{Question [1 point]}

From \href{https://www.cs.utexas.edu/~vijay/cs378-f17/projects/64-ia-32-architectures-software-developer-vol-3c-part-3-manual.pdf}{this Intel guide}, find out what the vmcs pointer in this struct stands for, and what it purpose it serves.

\begin{solution}
The vmcs is managed through a component of processor state called the VMCS pointer. The VMCS pointer holds the 64-bit address of the VMCS.
\end{solution}


\section{Question [1 point]}

What assembly instruction initializes the \texttt{vmcs} pointer? In other words, how do we change the \texttt{vmcs} pointer?

\begin{solution}
The VMCS pointer is read and written using the instructions VMPTRST and VMPTRLD\end{solution}
\end{document}

